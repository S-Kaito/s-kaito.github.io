# セキュリティ論第 3 回

1977 NBS(NISTの前身)が暗号の標準化を行う

ケルクホフスの原理
暗号化の仕組みではなく鍵の強さのみで暗号化の良し悪しを決定する

## DES 規格
入出力：64bit
鍵：56bit(+7bitの奇パリティ)
暗号化アルゴリズム：暗号株(Feistel型)と鍵生成部の２つ
暗号化、復号；16ラウンド

UNIXのパスワードに用いられていた(~1999.01)

## AES
入出力：128bit
鍵：128, 192, 256bit から選択
時間計算量・空間計算量が小さい
知的財産権行使の放棄

### アルゴリズム
ブロック長 n = 128 or 192 or 256 bit
n は32の倍数であり、8の倍数である

1word = 32bit = 8bit * 4
1block= 4 or 6 or 8 word

1. 鍵入力を8bit枚に区切り、それを有限体GF(2^8)の元とする
2. ラウンド数だけ以下の操作を行う
	1. ByteSub
		バイトごとに有限体GF(2^8)の乗法に関する逆元に置換する
		既約多項式: `m(x) = x^8 + x^4 + x^3 + x + 1`
		その後、1バイトを8bitベクトルとみなしアフィン変換を行う
	2. ShiftRow
		各行を決められた数だけ左Shiftする
	3. MixColumn
		各列をGF(2^8)の多項式とみなし、以下の多項式を乗じて`x^4+1`で割った剰余多項式を取る
		`a(x) = a[3]*x^3 + a[2]*x^2 + a[1]*x+a[0]`
		`c(x) = '03'x^3 + '01'x^2 + '01'x + '02'`

		`b(x) = (a(x) * c(x)) % (x^4+1)`
		`a(x) = b(x) * c^-1(x) % (x^4+1)`
	4. AddRoundKey
		暗号化途中のブロックと部分鍵のブロックのワードごとの排他的論理和を取る

### 復号
1. AddRoundKey
	暗号化文章のワードごとの排他的論理和を取る
2. ShiftRow
	各行を決められた数だけ右Shiftする
3. ByteSub
	定数ベクトルを足す
	逆行列を足し合わせる
4. MixColumn
	c(x) の逆元をかけて`x^4+1`で割った余り

### 鍵生成

### 利用モード、操作モード
Cipher: 物理的な単位 bit, byte, char, disit
Code  : 意味的な単位 単語
		codebook: codeの変換表

#### ECB(Electronic codebook)
codebookで暗号化する
メリット：	エラー伝播がない
		簡単である
		並列処理できる
デメリット：ブロック単位の平分の特徴がそのまま残る

#### CBC (Cipher Block Chaining)
i番目のブロックの暗号化の前にバッファに入っているi-1番目の暗号化の結果と
排他的論理和を取る
復号の際はバッファともう一度排他的論理和を取ることで
戻すことが可能

メリット：	ブロック単位の入れ回・削除・挿入に強い
		伝送誤り伝播が２ブロックまで
デメリット：同期誤りが回復しない
		並列処理が行えない

#### CFB (Cipher FeedBack)
平分を暗号化する際にその結果をシフトレジスタに保存し、
それを用いて次回以降の暗号化に用いる

メリット：	ブロック単位の入れかえ・削除・挿入に強い
		ブロック単位の同期誤りは自己回復する
デメリット：伝搬誤りが復号化側のシフトレジスタの中にある間
		違う結果が出力され続ける

#### OFB (Output FeedBack)
暗号化の結果の一部をシフトレジスタに保存し
それを用いて次回以降の暗号化に用いる

メリット：	ブロック単位の入れかえ・削除・挿入に強い
		誤り伝搬が全く起こらない
デメリット：同期誤りは回復しない

#### CTR モード (CounTeR Mode)
暗号化にカウンターの出力を用いる

メリット：	ブロック単位の入れかえ・削除・挿入に強い
		誤り伝搬が全く起こらない
デメリット：同期誤りは回復しない



- バースデーアタック
- 線形解読法
- 差分解読法